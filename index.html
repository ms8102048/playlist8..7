<!DOCTYPE html>
<html>
<head>
    <title>讀取測試</title>
</head>
<body>
    <h2>Google 試算表讀取測試</h2>
    <button onclick="testRead()">點我讀取雲端資料</button>
    <div id="output" style="margin-top:20px; border:1px solid #ccc; padding:10px;">
        等待讀取...
    </div>

    <script>
        const API_URL = "https://script.google.com/macros/s/AKfycbwDWdmTharCjjY6-k7-p8ZbOfUSfgJzVY5ozoGIU_8b-Pz9MuXIfLvFT98Rg65AzuwUlw/exec";

        function testRead() {
            document.getElementById('output').innerText = "讀取中，請稍候...";
            
            // 創建 JSONP 請求
            const script = document.createElement('script');
            const cbName = 'myCallback';
            
            // 定義收到資料後的處理動作
            window[cbName] = function(data) {
                document.getElementById('output').innerHTML = `
                    <b>讀取成功！</b><br>
                    清單內容：${data.list} <br>
                    URL：${data.url} <br>
                    時間：${data.time}
                `;
                delete window[cbName];
                document.body.removeChild(script);
            };

            script.src = `${API_URL}?callback=${cbName}&t=${Date.now()}`;
            document.body.appendChild(script);
        }
    </script>
</body>
</html>