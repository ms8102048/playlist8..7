<!DOCTYPE html>
<html>
<head><meta charset="UTF-8"><title>寫入測試</title></head>
<body>
    <h2>Google 試算表寫入測試</h2>
    <button onclick="testWrite()">點我把資料改為「成功寫入」</button>
    <div id="output" style="margin-top:20px; border:1px solid #ccc; padding:15px;">等待操作...</div>

    <script>
        const API_URL = "https://script.google.com/macros/s/AKfycbwDWdmTharCjjY6-k7-p8ZbOfUSfgJzVY5ozoGIU_8b-Pz9MuXIfLvFT98Rg65AzuwUlw/exec";

        function testWrite() {
            const out = document.getElementById('output');
            out.innerText = "上傳中...";

            const payload = {
                list: "寫入成功了",
                url: "SUCCESS_URL",
                time: 888
            };

            // 使用 POST 發送資料
            fetch(API_URL, {
                method: "POST",
                mode: "no-cors", // 重要：跨網域寫入必須用 no-cors
                headers: { "Content-Type": "text/plain" },
                body: JSON.stringify(payload)
            })
            .then(() => {
                out.innerHTML = "<b style='color:blue;'>指令已發出！</b><br>請現在去打開你的 Google 試算表，看看內容有沒有變。";
            })
            .catch(err => {
                out.innerText = "寫入發生錯誤: " + err;
            });
        }
    </script>
</body>
</html>